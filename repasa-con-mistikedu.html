<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>MistikQuiz</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
  :root {
    --bg: #f3f6ff;
    --card: #ffffff;
    --text: #111827;
    --border: #e5e7eb;
    --primary: #4f46e5;
    --correct: #16a34a;
    --error: #ef4444;
  }

  body {
    margin: 0;
    padding: 22px;
    font-family: system-ui;
    background: #eef2ff;
    display: flex;
    justify-content: center;
  }

  .app {
    width: 100%;
    max-width: 700px;
    background: var(--card);
    padding: 20px;
    border-radius: 20px;
    box-shadow: 0 0 20px rgba(0,0,0,0.08);
  }

  h1, h2 {
    text-align: center;
    margin: 0;
  }

  h1 { font-size: 28px; }
  h2 { margin-top: 6px; font-size: 17px; color: #666; }

  /* Botones Importar y Reiniciar ‚Äî mitad de ancho */
  .btn-row {
    display: flex;
    gap: 10px;
    margin-top: 12px;
  }

  .gray-btn {
    width: 50%;
    padding: 10px;
    border: none;
    background: #e5e7eb;
    color: #333;
    border-radius: 10px;
    font-size: 15px;
    cursor: pointer;
    transition: 0.2s;
  }
  .gray-btn:hover { background: #d1d5db; }

  /* Preguntas */
  .question-card {
    margin-top: 15px;
    padding: 16px;
    border-radius: 12px;
    border: 1px solid var(--border);
    background: #f8fafc;
  }

  .question-text { font-weight: bold; margin-bottom: 12px; }

  .options { display: grid; gap: 10px; }

  .option-btn {
    padding: 10px;
    background: white;
    border: 1px solid var(--border);
    border-radius: 10px;
    cursor: pointer;
    transition: 0.2s;
  }
  .option-btn:hover { background: #eef2ff; }

  .correct {
    background: #dcfce7 !important;
    border-color: #16a34a !important;
  }

  .incorrect {
    background: #fee2e2 !important;
    border-color: #ef4444 !important;
  }

  /* Resultado gamificado */
  .finish-box {
    margin-top: 20px;
    padding: 20px;
    text-align: center;
    border-radius: 16px;
    border: 2px solid var(--border);
    background: #f8fafc;
  }

  .medal { font-size: 60px; margin-bottom: 8px; }
  .score { font-size: 28px; font-weight: bold; }
  .comment { font-size: 18px; color: #555; }
</style>
</head>
<body>

<div class="app">

  <h1>ü§ì Repasa con MistikEdu</h1>

  <!-- Input oculto, se activa solo al pulsar "Importar" -->
  <input type="file" id="import-file" accept=".json" style="display:none">

  <div id="question-container"></div>
  <div id="finish-message" style="display:none;"></div>

  <!-- Botones lado a lado -->
  <div class="btn-row">
    <button id="import-btn" class="gray-btn">üìÅ Importar</button>
    <button id="reiniciar-btn" class="gray-btn">üîÑ Reiniciar</button>
  </div>

</div>

<script>
/* ================================
   Preguntas por defecto
================================ */



let questions = [
{
  text: "¬øQu√© color tiene el cielo despejado?",
  options: ["Verde", "Azul", "Rojo", "Amarillo"],
  correct: 1
},
{
  text: "¬øQu√© necesitamos para vivir?",
  options: ["Agua", "Diamantes", "Oro", "Wifi"],
  correct: 0
},
{
  text: "¬øCu√°l es el astro que nos da luz durante el d√≠a?",
  options: ["La Luna", "El Sol", "Marte", "Venus"],
  correct: 1
},
{
  text: "¬øQu√© usamos para escuchar sonidos?",
  options: ["Los ojos", "Las manos", "Los o√≠dos", "La nariz"],
  correct: 2
}

  // ...a√±ade aqu√≠ el resto de tus preguntas...
];

/* ================================
   Utilidades
================================ */
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

let index = 0;
let correctCount = 0;
shuffle(questions);

/* ================================
   Mostrar pregunta
================================ */
function showQuestion() {
  const container = document.getElementById("question-container");
  container.innerHTML = "";

  if (index >= questions.length) {
    showFinalScore();
    return;
  }

  const q = questions[index];
  const card = document.createElement("div");
  card.className = "question-card";

  card.innerHTML = `
    <div class="question-text">${q.text}</div>
    <div class="options"></div>
  `;

  const optionsDiv = card.querySelector(".options");

  q.options.forEach((opt, i) => {
    const btn = document.createElement("button");
    btn.className = "option-btn";
    btn.textContent = opt;

    btn.addEventListener("click", () => checkAnswer(btn, i));

    optionsDiv.appendChild(btn);
  });

  container.appendChild(card);
}

/* ================================
   Corregir respuesta
================================ */
function checkAnswer(btn, chosenIndex) {
  const q = questions[index];
  const all = document.querySelectorAll(".option-btn");

  all.forEach(b => b.disabled = true);

  if (chosenIndex === q.correct) {
    btn.classList.add("correct");
    correctCount++;

    confetti({ particleCount: 60, spread: 60, origin: { y: 0.3 } });

  } else {
    btn.classList.add("incorrect");
    all[q.correct].classList.add("correct");
  }

  setTimeout(() => {
    index++;
    showQuestion();
  }, 1200);
}

/* ================================
   Resultado gamificado
================================ */
function showFinalScore() {
  const container = document.getElementById("question-container");
  container.innerHTML = "";

  const perc = Math.round((correctCount / questions.length) * 100);

  let medal = "ü•â";
  let message = "¬°Puedes mejorar!";

  if (perc >= 80) {
    medal = "ü•á";
    message = "¬°Espectacular!";
    confetti({ particleCount: 200, spread: 90, origin: { y: 0.4 }});
  } else if (perc >= 50) {
    medal = "ü•à";
    message = "¬°Buen trabajo!";
  }

  container.innerHTML = `
    <div class="finish-box">
      <div class="medal">${medal}</div>
      <div class="score">${perc}%</div>
      <div class="comment">${message}</div>
      <br>
      <small>Has acertado ${correctCount} de ${questions.length} preguntas.</small>
    </div>
  `;
}

/* ================================
   Importar JSON
================================ */
document.getElementById("import-btn").addEventListener("click", () => {
  document.getElementById("import-file").click();
});

document.getElementById("import-file").addEventListener("change", function () {
  const file = this.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = e => {
    try {
      const imported = JSON.parse(e.target.result);
      if (Array.isArray(imported)) {
        questions = imported;
        restartQuiz();
      } else {
        alert("JSON no v√°lido.");
      }
    } catch {
      alert("Error leyendo JSON.");
    }
  };

  reader.readAsText(file);
});

/* ================================
   Reiniciar
================================ */
function restartQuiz() {
  index = 0;
  correctCount = 0;
  shuffle(questions);
  document.getElementById("finish-message").style.display = "none";
  showQuestion();
}

document.getElementById("reiniciar-btn").addEventListener("click", restartQuiz);

/* ================================
   Inicio
================================ */
showQuestion();

</script>
</body>
</html>
